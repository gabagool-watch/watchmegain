# Database
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/pnltracker?schema=public"
# Optional: direct connection string (recommended for Prisma migrations with Supabase)
# DIRECT_URL="postgresql://postgres:<PASSWORD>@<HOST>:5432/postgres?schema=public&sslmode=require"

# Redis
REDIS_URL="redis://localhost:6379"

# Sync Configuration
SYNC_INTERVAL_SECONDS=120
REORG_LOOKBACK_MINUTES=120

# ===========================================
# Polymarket Data Sources
# ===========================================

# Goldsky Subgraph Endpoints (Polymarket on Polygon)
# Activity subgraph for trades/fills
GOLDSKY_ACTIVITY_ENDPOINT="https://api.goldsky.com/api/public/project_cl6mb8i9h0003e201j6li0diw/subgraphs/polymarket-activity-polygon/prod/gn"

# Positions subgraph (optional - we calculate from trades)
GOLDSKY_POSITIONS_ENDPOINT="https://api.goldsky.com/api/public/project_cl6mb8i9h0003e201j6li0diw/subgraphs/polymarket-positions-polygon/prod/gn"

# PnL subgraph (optional - we use our own PnL engine)
GOLDSKY_PNL_ENDPOINT="https://api.goldsky.com/api/public/project_cl6mb8i9h0003e201j6li0diw/subgraphs/polymarket-pnl-polygon/prod/gn"

# Gamma Markets API (for market metadata)
GAMMA_MARKETS_API="https://gamma-api.polymarket.com"

# CLOB API (for current prices)
POLYMARKET_CLOB_API="https://clob.polymarket.com"

# Data API
POLYMARKET_DATA_API="https://data-api.polymarket.com"

# ===========================================
# Polymarket API Credentials (for authenticated endpoints)
# ===========================================
# Get these from polymarket.com → Settings → API
POLYMARKET_API_KEY=""
POLYMARKET_API_SECRET=""
POLYMARKET_API_PASSPHRASE=""
POLYMARKET_ADDRESS=""
# Note: POLYMARKET_PRIVATE_KEY is only needed for placing orders, not for tracking

# ===========================================
# Blockchain Data (Recommended for trade history)
# ===========================================
# Get a FREE API key at: https://polygonscan.com/apis
# This enables fetching trades directly from the blockchain
POLYGONSCAN_API_KEY=""

# Rate limiting
API_RATE_LIMIT_MS=100
API_MAX_RETRIES=3

# ===========================================
# Provider Selection
# ===========================================
# Options: "mock" | "polymarket"
DATA_PROVIDER="polymarket"

# Admin Auth (basic)
ADMIN_PASSWORD=changeme

# App
NEXT_PUBLIC_APP_URL=http://localhost:3000

# ===========================================
# BTC 15m Market Asset IDs (for lag recorder)
# ===========================================
# Run: npm run find-btc-assets
# Or manually find from: https://polymarket.com/event/btc-updown-15m-*
# These are the token_id / asset_id values for UP and DOWN outcomes
POLYMARKET_BTC_UP_ASSET_ID=""
POLYMARKET_BTC_DOWN_ASSET_ID=""

# Throttle how often we write Binance bookTicker to Postgres (ms)
# Without this, Postgres will get hammered and the lag dashboard will feel slow.
BINANCE_SAMPLE_MS=100

# ===========================================
# Chainlink (on-chain) BTC/USD via WebSocket
# ===========================================
# Required: Polygon WebSocket RPC URL for eth_subscribe (logs)
POLYGON_WSS_URL=""
# Chainlink BTC/USD feed on Polygon (commonly used address; verify if needed)
CHAINLINK_BTC_USD_FEED_ADDRESS="0xc907E116054Ad103354f2D350FD2514433D57F6f"
# Feed decimals (BTC/USD is typically 8)
CHAINLINK_DECIMALS=8
# Poll interval for latestRoundData over WS (ms). Emits only on change.
CHAINLINK_POLL_MS=250

# ===========================================
# Polymarket RTDS (crypto_prices)
# ===========================================
# Polymarket's Real-Time Data Socket. Used to capture Polymarket's own BTC reference price feed.
POLYMARKET_RTDS_URL="wss://ws-live-data.polymarket.com"

# ===========================================
# HTTP keep-alive (lower REST latency)
# ===========================================
POLY_HTTP_KEEPALIVE=1
POLY_HTTP_KEEPALIVE_CONNECTIONS=50

# ===========================================
# Maker Ladder Bot (post-only bursts)
# ===========================================
# Safety first: default is DRY RUN. Set to 0 to actually place/cancel orders.
MAKER_DRY_RUN=1
MAKER_CANCEL_ON_START=1
# If 1, uses the low-latency DELETE /cancel-all endpoint instead of enumerating open orders.
MAKER_CANCEL_ALL_ON_START=0

# How many price levels to quote per side
MAKER_LEVELS=3
# Price tick for quoting (probability units; typical is 0.01)
MAKER_TICK=0.01
# Order "size" passed to CLOB. Verify units on your account (keep small at first).
MAKER_SIZE=5

# How often to recompute desired orders and cancel/replace (ms)
MAKER_REFRESH_MS=750
# If 1: react immediately to websocket updates (debounced), plus a safety timer.
MAKER_EVENT_DRIVEN=1
MAKER_EVENT_DEBOUNCE_MS=15

# ===========================================
# Latency benchmark
# ===========================================
LAT_BENCH_ITERS=20
LAT_BENCH_USD_SIZE=1
LAT_BENCH_TICK=0.01
LAT_BENCH_SAFE_TICKS_AWAY=25
LAT_BENCH_TIMEOUT_MS=5000
# Disabled by default (safety)
LAT_BENCH_TAKER=0
# Burst limits per loop
MAKER_BURST_PLACE=5
MAKER_BURST_CANCEL=10

# Quote both UP and DOWN assets (true) or only UP (false)
MAKER_QUOTE_BOTH_ASSETS=1
# Quote both BUY and SELL sides (true) or only BUY (false)
MAKER_QUOTE_BOTH_SIDES=1

# Spike guard: during fast Binance moves, cancel resting quotes to reduce adverse selection
MAKER_SPIKE_USD=6
MAKER_SPIKE_WINDOW_MS=250
MAKER_SPIKE_COOLDOWN_MS=1200
